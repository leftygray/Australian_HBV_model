# Run HBV model 
# =============

Authors: Richard T. Gray, Neil Bretana

This script is used to load a project and run in the HBV model. 

```{r Initialize script}
# Clear workspace
rm(list = ls()) 

# Setup directories after setting working directory to source file 
# directory (so it is easy to move code around)
basePath <- getwd()
dataPath <- file.path(basePath, "data") # original data stored in ./BM datasets
Rcode <- file.path(basePath, "code")
projectFolder <- file.path(basePath, "projects")

# Load useful libraries
source(file.path(Rcode, "LoadLibrary.R"))
LoadLibrary("dplyr")
LoadLibrary("tidyr")

# Source model files
source(file.path(Rcode, "HBVmodel.R"))

```

## User specifications

```{r User specifications}
# Specify project to run
project <- "Australia_HBV_estimates-BM"

# Options
runSamples <- FALSE

```

## Main script

The first chunk loads all the project specifications and inputs.

```{r Load project}
# This loads pg, inputs, best_estimates, param_sets, best_initial_pop
# param_initial_pops, transitions to the workspace.
load(file.path(projectFolder, project, paste0(project, ".rda")))

```

The next chunk runs the all the simulations in a project.

```{r Run model}

# Start clock
tic <- proc.time()

# Run model on best estimates
bestResults <- HBVmodel(pg, best_estimates, best_initial_pop, pg$pts,
                        transitions)

# Run sampled parameter sets
# if (runSamples) {
# }

# Stop the clock
toc <- proc.time() - tic

```
